<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
            integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
            crossorigin="anonymous"
        />
    </head>
    <div class="container">
        <h2 class="page-header">promise</h2>
        <button class="btn btn-primary">click</button>
    </div>
    <body>
        <script>
            //生成隨機數
            function rand(m, n) {
                return Math.ceil(Math.random() * (n - m + 1)) + m - 1;
            }
            /*
                點擊按鈕, 2s後顯示是否中獎(30%中獎機率)
                    若中獎彈出 恭喜,獎品為xxx
                    若未中獎彈出 再接再厲
            */

            // 獲取元素對象
            const btn = document.querySelector(".btn");
            // 綁定點擊事件
            btn.addEventListener("click", function () {
                // setTimeout(() => {
                //     // 30% 1-100   1 2 30
                //     // 獲取從1-100 的一個隨機數
                //     let n = rand(1, 100);
                //     // 判斷
                //     if (n <= 30) {
                //         alert("恭喜中獎");
                //     } else {
                //         alert("再接再厲");
                //     }
                // }, 1000);

                //Promise 形式實現

                // resolve 解決 函數類型的數據
                // reject 拒絕 函數類型的數據
                const p = new Promise((resolve, reject) => {
                    setTimeout(() => {
                        // 30% 1-100   1 2 30
                        // 獲取從1-100 的一個隨機數
                        let n = rand(1, 100);
                        // 判斷
                        if (n <= 30) {
                            resolve(n); //將promise 對象的狀態設置為 '成功'
                        } else {
                            reject(n); //將promise 對象的狀態設置為 '失敗'
                        }
                    }, 1000);
                });
                // 調用 then 方法
                p.then(
                    (value) => {
                        alert("恭喜中獎,中獎數字為" + value);
                    },
                    (reason) => {
                        alert("再接再厲,你的號碼為" + reason);
                    }
                );
            });
        </script>
    </body>
</html>
